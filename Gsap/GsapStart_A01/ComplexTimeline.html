<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Complex Timeline</title>
  <script src="../assets/libs/gsap3.13.0/gsap.min.js"></script>
  <script src="../assets/libs/gsap3.13.0/GSDevTools.min.js"></script>
  <style>
    * {
      padding: 0;
      margin: 0;
    }
    body {
      width: 100vw;
      height: 100vh;
      overflow: hidden;
      background-color: #232529;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    #svg-stage {
      opacity: 0;
      width:57.14%;
      max-height:248px;
    }
  </style>
</head>
<body>
  <svg id="svg-stage" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 248 248">
      
    <g class="group1">
      <image href="../assets/images/flair-2.png" />
      <image href="../assets/images/flair-2.png" />
      <image href="../assets/images/flair-2.png" />
    </g>

    <g class="group2">
      <image href="../assets/images/flair-3.png" mask="url(#g2_mask)"/>
    </g>
    <mask id="g2_mask" fill="#fff">
      <circle cx="124" cy="0" r="0"/>
      <circle cx="124" cy="248" r="0"/>
    </mask>

    <g class="group3">
      <image href="../assets/images/flair-4.png" mask="url(#g3_mask)"/>
    </g>
    <mask id="g3_mask" fill="#fff">
      <rect x="0" y="0" width="124" height="124"/>
      <rect x="124" y="0" width="124" height="124"/>
      <rect x="0" y="124" width="124" height="124"/>
      <rect x="124" y="124" width="124" height="124"/>
    </mask>

    <g class="group4">     
      <image href="../assets/images/flair-5.png" x="70" />
    </g>

    <g class="group5">
      <image href="../assets/images/flair-7.png" mask="url(#g5_mask)"/>
    </g>
    <mask id="g5_mask" fill="#fff">
      <path d="M0 248h248L124 0 0 247z"/>
      <circle cx="124" cy="83" r="83"/>
    </mask>
  </svg>
  <script>
    // 使用 GSAP 的 set 方法立即设置元素的属性，不涉及动画
    gsap.set('#svg-stage', {opacity: 1});

    // 创建一个时间轴对象，用于序列化动画。repeatDelay: 0.5 表示每次重复之间的延迟为 0.5 秒
    const tl = gsap.timeline({repeat: -1, repeatDelay: 0.5});

    // 第一组动画
    // .group1 元素从 scale: 0.1 缩放到 scale: 1，持续时间 0.35 秒，使用 expo.inOut 缓动函数
    tl.fromTo('.group1', {scale: 0.1, transformOrigin: '124 124'}, {duration: 0.35, scale: 1, ease: 'expo.inOut'})
      // .group1 元素旋转 15 度，持续时间 1.2 秒，无缓动函数，从 0.1 秒开始
      .to('.group1', {duration: 1.2, rotate: 15, ease: 'none'}, 0.1)
      // .group1 内的 image 元素分别缩放、移动，使用 back 缓动函数，从 0.4 秒开始
      .to('.group1 image', {scale: (i) => [0.4, 0.2, 0.3][i], x: (i) => [0, 135, 100][i], y: (i) => [90, 24, 124][i], ease: 'back'}, 0.4)
      // .group1 内的 image 元素逐渐变为透明，持续时间 0.01 秒，间隔 0.06 秒，从 1.1 秒开始
      .to('.group1 image', {duration: 0.01, opacity: 0, stagger: 0.06}, 1.1)

      // 第二组动画
      // '#g2_mask circle' 元素的半径从 0 增加到 124，持续时间 0.4 秒，使用 circ 缓动函数，从 1.3 秒开始
      .to('#g2_mask circle', {duration: 0.4, attr: {r: "124"}, ease: 'circ'}, 1.3)
      // .group2 元素从 scale: 1 缩放到 scale: 0.9，持续时间 1.5 秒，无缓动函数，从 1.3 秒开始
      .fromTo('.group2', {scale: 1, transformOrigin: '124 124'}, {duration: 1.5, scale: 0.9, ease: 'none'}, 1.3)
      // '#g2_mask circle' 元素的中心点在 X 轴方向上移动，持续时间 0.3 秒，使用 sine.in 缓动函数，从 2.45 秒开始
      .to('#g2_mask circle', {duration: 0.3, attr: {cx: (i) => ["+=248", "-=248"][i]}, ease: 'sine.in'}, 2.45)

      // 第三组动画
      // .group3 元素从 rotate: -90 旋转到 rotate: 0，持续时间 0.9 秒，使用 expo 缓动函数，从 2.6 秒开始
      .fromTo('.group3', {transformOrigin: '124 124', rotate: -90}, {duration: 0.9, rotate: 0, ease: 'expo'}, 2.6)
      // '#g3_mask rect' 元素的 scale 从 0 增加到 1，持续时间 0.4 秒，使用 expo 缓动函数，间隔 -0.03 秒，从 2.6 秒开始
      .fromTo('#g3_mask rect', {transformOrigin: (i) => ['0 124', '124 0', '124 124', '248 124'][i], scale: 0}, {duration: 0.4, scale: 1, ease: 'expo', stagger: -0.03}, 2.6)
      // .group3 元素的 scale 缩小到 0，持续时间 0.01 秒，从 3.7 秒开始
      .to('.group3', {duration: 0.01, scale: 0}, 3.7)

      // 第四组动画
      // .group4 内的 image 元素的 opacity 设置为 0，持续时间 0.01 秒，从 3.8 秒开始
      .from('.group4 image', {duration: 0.01, opacity: 0}, 3.8)
      // .group4 元素从 rotate: 15 旋转到 rotate: 0，scale 从 0.2 缩放到 0.85，持续时间 0.5 秒，使用 bounce 缓动函数，从 3.8 秒开始
      .fromTo('.group4', {transformOrigin: '83 124', rotate: 15, scale: 0.2}, {duration: 0.5, rotate: 0, scale: 0.85, ease: 'bounce'}, 3.8)
      // .group4 内的 image 元素的 opacity 设置为 0，持续时间 0.01 秒，从 4.7 秒开始
      .to('.group4 image', {duration: 0.01, opacity: 0}, 4.7)

      // 第五组动画
      // '#g5_mask path' 元素的 scale 从 0 增加到 1，持续时间 0.8 秒，使用 expo 缓动函数，从 4.7 秒开始
      .fromTo('#g5_mask path', {transformOrigin: '124 124', scale: 0}, {duration: 0.8, scale: 1, ease: 'expo'}, 4.7)
      // '#g5_mask circle' 元素的 scale 从 0 增加到 1，持续时间 0.8 秒，使用 expo 缓动函数，从 4.7 秒开始
      .fromTo('#g5_mask circle', {transformOrigin: '83 0', scale: 0}, {scale: 1, ease: 'expo'}, 4.7);

    // 创建 GSDevTools 实例，用于调试时间轴动画
    // GSDevTools.create({animation: tl});


  </script>
</body>
</html>